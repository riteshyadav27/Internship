<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/CSS_Files/signup.css">
    <link rel="stylesheet" href="/CSS_Files/style.css">
    <title>Signup Page</title>
</head>

<body>
    <header class="">
        <a href="/index.html"><span class="comp-name">Feynman Innovations Pvt. Ltd.</span></a>
        <div class="navbar ">

            <a href="#"> <span class="nav-items" id="logout" style="display: none;">Logout</span> </a>
            <a href="../HTML_Files/login.html"> <span class="nav-items">Login</span> </a>

        </div>


    </header>

    <section class="container">
        <div class="signup">
            <h1 style="margin-bottom: 5px; font-size: 30px;">Sign Up</h1>
            <p style="color: rgb(95, 104, 104);margin-top: 2px; margin-bottom: 20px; font-size: 14px;">Please Enter
                Details</p>

            <label for="name" style="margin-bottom: 2px;">Name <b style="color: red;">*</b></label><br>
            <input class="input" type="text" id="name" name="name" placeholder="Enter Your Name"><br><br>

            <label for="name" style="margin-bottom: 2px;">Company Name <b style="color: red;">*</b></label><br>
            <input class="input" type="text" id="comp-name" placeholder="Enter Your Company Name"><br><br>

            <label for="name" style="margin-bottom: 2px;">Designation <b style="color: red;">*</b></label><br>
            <input class="input" type="text" id="designation" placeholder="Enter Your Designation"><br><br>

            <label for="name" style="margin-bottom: 2px;">Mobile No. <b style="color: red;">*</b></label><br>
            <input class="input" type="tel" id="mob-no" placeholder="Enter Your Mobile No"><br><br>

            <label for="email" style="margin-bottom: 2px;">Email <b style="color: red;">*</b></label><br>
            <input class="input" type="email" id="email" name="email" placeholder="Enter Your Email" "><br><br>

            <label for=" pwd" style="margin-bottom: 20px;">Password <b style="color: red;">*</b></label><br>
            <input class="input" type="password" id="pwd" name="password" placeholder="Enter Password"><br><br>

            <label for=" pwd" style="margin-bottom: 20px;">Confirm Password <b style="color: red;">*</b></label><br>
            <input class="input" type="password" id="cnf-pwd" name="password" placeholder="Confirm Password"><br><br>

            <br>
            <button class="btn" id="signup" style="background: rgb(28, 26, 26); color: aliceblue; ">Sign Up</button><br>


        </div>

        <img id="bgimg" src="/Images/signup.svg" alt="bg_img">
    </section>

    <footer class="border">
        <div class="footerContent">
            <hr>
            <p>Contact us on <a href="">sva[at]feynmaninnovations[dot]in</a> for Licensing and suggestions</p>
            <p><a href="">Â© Feynman Innovations Pvt. Ltd.</a></p>
            <p>450 xyz, East Mumbai, Mumbai, 110220, India</p>

        </div>

        <div class="footerContent2">
            <p><a href="">Terms and Condition</a> <a href="">Privacy Policy</a></p>
        </div>
    </footer>
</body>

<script type="module" src="../JavaScript_Files/login.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script type="module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";
    import { getDatabase, ref, set, push } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCk1WBSSC7TDHt-PscckKwPLsO-KpsWeuA",
        authDomain: "login-auth-a4895.firebaseapp.com",
        databaseURL: "https://login-auth-a4895-default-rtdb.firebaseio.com",
        projectId: "login-auth-a4895",
        storageBucket: "login-auth-a4895.appspot.com",
        messagingSenderId: "488435744810",
        appId: "1:488435744810:web:97f4cd598a461001e4c353"
    };

    firebase.initializeApp(firebaseConfig)
    const auth = getAuth();
    const db = getDatabase();




    const randomNo = () => {
        return Math.floor((Math.random() * 100000) + 1)
    }


    //----- New Registration code start	  
    document.getElementById("signup").addEventListener("click", async function () {

        var name = document.getElementById("name").value;
        var email = document.getElementById("email").value;
        var password = document.getElementById("pwd").value;
        var cnf_password = document.getElementById("cnf-pwd").value;
        var comp_name = document.getElementById("comp-name").value;
        var desgn = document.getElementById("designation").value;
        var mobNo = document.getElementById("mob-no").value;

        // let username = name.split(" ")[0]

        // username = username + randomNo()  + ""
        // firebase.database().ref('Users/').on('value', (snap) => {

        //     console.log(snap.val());

        //     for (const usernamesInDB in snap.val()) {
                
        //         if( usernamesInDB === username ){
        //             username = ""
        //             username = username + randomNo()  + ""
        //         }
                
        //     }

        // })



        if (name === "" || email === "" || comp_name === "" || desgn === "") {
            alert("Please Fill all necessary details")
        }

        else {

        if (password === cnf_password  ) {

            // For new registration
            createUserWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {


                    const root = ref(db, "Users/" + userCredential.user.uid)
                    const newRoot = push(root)
                    set(newRoot, {
                        name,
                        email,
                        password,
                        comp_name,
                        desgn,
                        mobNo
                        
                    }).then(()=>{
                        localStorage.setItem("UID" ,userCredential.user.uid )
                        alert("Sign Up Successfull !!");
                    }).catch((e)=>{
                        alert(e)
                    })


                    // window.location.href = "../HTML_Files/login.html";
                    // ...
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.log(errorMessage);
                    alert(error);
                });

        }
        else {
            alert("Password don't match...Please Try Again")
        }

        }


    });


</script>

</html>